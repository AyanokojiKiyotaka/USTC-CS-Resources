# 计算机体系结构 HW1

## EX1

某台计算机执行标准测试程序, 程序中指令类型, 出现频率, 需要时钟周期如下:
|指令类型|指令出现频率|需要时钟周期数|
|:-|:-|:-|
|R|30%|2|
|I|25%|3|
|S|20%|2|
|U|15%|4|
|B|5%|4|
|J|4%|2|

### 1.1
计算CPI.
CPI=30%*2+25%*3+20%*2+15%*4+5%*4+5%*2=2.65

### 1.2
比较两种方案:
A. 整体时钟周期缩短到原本的 0.9
B. B 类型和 U 类型指令需要的时钟周期减少 1

对于 A 方案, 耗时为 $T_A=2.65*0.9*CLK\_CYCLE=2.385*CLK\_CYCLE$;

对于 B 方案, $T_B=(30\%*2+25\%*3+20\%*2+15\%*3+5\%*3+5\%*2)*CLK\_CYCLE=2.45*CLK\_CYCLE$

因此就 **总时间** 而言, 方案 A 更好.

## EX2

我们通过添加高性能硬件模块来提升机器的性能, 当运算通过高性能模块进行加速时, 其速度是正常运行的 20 倍, 将通过高性能模块进行加速的运算花费的时间百分比记为 $\alpha$(加速后所测得执行时间百分比).

### 2.1
$\alpha$ 达到多少时, 运算整体加速比达到 3 ?
设加速前后计算时间为 $t_0, t_1$, 则 $t_0=20\alpha t_1 + (1-\alpha)t_1$  
所以整体运算加速比是 $\frac{t_0}{t_1}=\frac{20\alpha t_1 + (1-\alpha)t_1}{t_1}=20\alpha+(1-\alpha)=19\alpha+1=3$  
因此 $\alpha$ 达到 $\frac{2}{19}=0.105$ 的时候, 运算整体加速比达到 3.

### 2.2
在运算整体加速比为 3 的情况下, 被加速的运算在原执行时间中的比例为多少?

显然, 占比为 $\frac{20\alpha t_1}{t_0}=\frac{20\alpha t_1}{20\alpha t_1 + (1-\alpha)t_1}=\frac{20\alpha}{19\alpha+1}\approx 0.702$ (代入 $\alpha=\frac{2}{19}$)

### 2.3
$\alpha$ 达到多少时, 运算整体加速比能达到此加速方式最大加速比的一半.

加速比为 $19\alpha+1$, 而 $\alpha\in[0,1]$, 故最大加速比为 $20$, 其一半是 $10$,  
进而, 若 $10=19\alpha+1$, 则 $\alpha=9/19\approx0.4737$
<!-- 运算最大加速比为将该模块优化到耗时为 0, 即 $\frac{\alpha}{1-\alpha}$, 其一半是 $\frac{1}{2}\frac{\alpha}{1-\alpha}$,  
故有 $19\alpha-1=\frac{1}{2}\frac{\alpha}{1-\alpha}$, 从而 $\alpha=$
(38-2a)(1-a)=a, 38-41a+2a^2=0 -->
## EX3
我们为一种实时应用设计系统, 这种应用要求必须在指定期限之前完成, 提前完成计算没有收益. 我们发现, 在最糟糕的情况下, 这一系统执行必须代码的速度是最低要求速度的两倍.

### 3.1
如果以当前速度执行计算, 并在完成任务后关闭系统, 可节省多少能量?

即相当于有一半的时间系统是关闭的, 因此可以节省 **50%** 的能量
### 3.2
如果将电压和频率设置为现在的一半, 可以节省多少能量?
$\frac{Energy_{new}}{Energy_{old}}=\frac{Voltage_{new}^2}{Voltage_{old}^2}=\frac{1}{4}$, 故可以节省 75% 的能量